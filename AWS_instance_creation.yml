
- name : ec2-launcher

  hosts : localhost

  become: false
  
  connection : local

  tasks :

  - name : launch ec2

    ec2 : 

     instance_type : t2.micro

     key_name : kalaivanan

     image : ami-07c1207a9d40bc3bd

     region : us-east-2

     group : sg-09cba8e12824141af

     count : 1

     vpc_subnet_id : subnet-6d59c221

     wait : yes

     assign_public_ip : yes
     
     register: ec2_out



  - name: Wait for SSH to come up

    wait_for: host="{{ ec2_out.tagged_instances[0].public_dns_name }}" port=22 delay=10  timeout=300
